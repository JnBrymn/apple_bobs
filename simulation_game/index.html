<!-- 
UNIVERSAL SIMULATION - Everything in One!
A massive simulation game that combines:
- City building and management
- Ecosystem simulation with plants and animals
- Space exploration and colonization
- Weather and climate systems
- Resource management and economy
- Technology research and advancement
- Population growth and society
- Natural disasters and events
- Multiple biomes and environments
- Time progression and evolution
-->
<!DOCTYPE html>
<html>
<head>
    <title>üåç Universal Simulation üåç</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #0c1445 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%);
            font-family: 'Orbitron', monospace;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            position: relative;
            animation: backgroundShift 30s ease-in-out infinite;
        }
        
        @keyframes backgroundShift {
            0%, 100% { background: linear-gradient(135deg, #0c1445 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #533483 100%); }
            25% { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 25%, #0f3460 50%, #533483 75%, #0c1445 100%); }
            50% { background: linear-gradient(135deg, #16213e 0%, #0f3460 25%, #533483 50%, #0c1445 75%, #1a1a2e 100%); }
            75% { background: linear-gradient(135deg, #0f3460 0%, #533483 25%, #0c1445 50%, #1a1a2e 75%, #16213e 100%); }
        }
        
        /* Animated starfield */
        .starfield {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }
        
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 4s infinite;
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.2; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.3); }
        }
        
        /* Main container */
        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        /* Header */
        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(15px);
            border-bottom: 3px solid #4ecdc4;
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.3);
        }
        
        #title {
            font-size: 2.5em;
            font-weight: 900;
            background: linear-gradient(45deg, #4ecdc4, #44a08d, #96ceb4, #ffeaa7, #dda0dd, #98d8c8);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientShift 4s ease-in-out infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        #stats {
            display: flex;
            gap: 15px;
            font-size: 1em;
            flex-wrap: wrap;
        }
        
        .stat {
            background: rgba(78, 205, 196, 0.2);
            padding: 8px 12px;
            border-radius: 10px;
            border: 1px solid #4ecdc4;
            backdrop-filter: blur(5px);
        }
        
        .stat-value {
            color: #ffeaa7;
            font-weight: bold;
        }
        
        /* Game canvas */
        #gameCanvas {
            flex: 1;
            background: #1a1a2e;
            border: 3px solid #4ecdc4;
            margin: 10px;
            border-radius: 15px;
            cursor: crosshair;
            box-shadow: 0 0 40px rgba(78, 205, 196, 0.2);
        }
        
        /* Control panels */
        .panel {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(15px);
            border: 2px solid #4ecdc4;
            border-radius: 15px;
            padding: 15px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 0 30px rgba(78, 205, 196, 0.2);
        }
        
        #buildPanel {
            top: 80px;
            left: 20px;
            max-width: 280px;
        }
        
        #infoPanel {
            top: 80px;
            right: 20px;
            max-width: 300px;
        }
        
        #researchPanel {
            bottom: 20px;
            left: 20px;
            max-width: 350px;
        }
        
        #eventsPanel {
            bottom: 20px;
            right: 20px;
            max-width: 300px;
        }
        
        .panel-title {
            color: #4ecdc4;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid #4ecdc4;
            padding-bottom: 8px;
        }
        
        .build-btn {
            background: rgba(78, 205, 196, 0.2);
            border: 1px solid #4ecdc4;
            color: #fff;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .build-btn:hover {
            background: rgba(78, 205, 196, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 205, 196, 0.3);
        }
        
        .build-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .info-item {
            background: rgba(78, 205, 196, 0.1);
            border: 1px solid #4ecdc4;
            border-radius: 8px;
            padding: 8px;
            margin: 5px 0;
            font-size: 0.9em;
        }
        
        .info-label {
            color: #4ecdc4;
            font-weight: bold;
        }
        
        .info-value {
            color: #ffeaa7;
        }
        
        .research-item {
            background: rgba(150, 206, 180, 0.1);
            border: 1px solid #96ceb4;
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .research-item:hover {
            background: rgba(150, 206, 180, 0.3);
            transform: translateX(5px);
        }
        
        .research-item.researched {
            background: rgba(150, 206, 180, 0.4);
            border-color: #ffeaa7;
        }
        
        .event-item {
            background: rgba(255, 234, 167, 0.1);
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 8px;
            margin: 5px 0;
            font-size: 0.9em;
            animation: eventGlow 2s ease-in-out infinite;
        }
        
        @keyframes eventGlow {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 234, 167, 0.3); }
            50% { box-shadow: 0 0 20px rgba(255, 234, 167, 0.6); }
        }
        
        /* Progress bars */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 5px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4, #44a08d);
            transition: width 0.3s ease;
        }
        
        /* Responsive design */
        @media (max-width: 1200px) {
            #stats {
                font-size: 0.8em;
                gap: 8px;
            }
            
            .stat {
                padding: 6px 8px;
            }
            
            .panel {
                max-width: 250px;
            }
        }
    </style>
</head>
<body>
    <!-- Animated starfield -->
    <div class="starfield" id="starfield"></div>
    
    <div id="gameContainer">
        <!-- Header -->
        <div id="header">
            <h1 id="title">üåç Universal Simulation üåç</h1>
            <div id="stats">
                <div class="stat">
                    Time: <span class="stat-value" id="gameTime">Year 1</span>
                </div>
                <div class="stat">
                    Population: <span class="stat-value" id="population">0</span>
                </div>
                <div class="stat">
                    Resources: <span class="stat-value" id="resources">1000</span>
                </div>
                <div class="stat">
                    Energy: <span class="stat-value" id="energy">100</span>
                </div>
                <div class="stat">
                    Food: <span class="stat-value" id="food">100</span>
                </div>
                <div class="stat">
                    Technology: <span class="stat-value" id="techLevel">1</span>
                </div>
                <div class="stat">
                    Happiness: <span class="stat-value" id="happiness">50</span>%
                </div>
                <div class="stat">
                    Environment: <span class="stat-value" id="environment">100</span>%
                </div>
            </div>
        </div>
        
        <!-- Game canvas -->
        <canvas id="gameCanvas"></canvas>
        
        <!-- Build Panel -->
        <div id="buildPanel" class="panel">
            <div class="panel-title">üèóÔ∏è Build & Create</div>
            <div class="build-btn" onclick="selectBuilding('house')">
                üè† House (Cost: 50)
            </div>
            <div class="build-btn" onclick="selectBuilding('farm')">
                üåæ Farm (Cost: 100)
            </div>
            <div class="build-btn" onclick="selectBuilding('factory')">
                üè≠ Factory (Cost: 200)
            </div>
            <div class="build-btn" onclick="selectBuilding('powerplant')">
                ‚ö° Power Plant (Cost: 300)
            </div>
            <div class="build-btn" onclick="selectBuilding('hospital')">
                üè• Hospital (Cost: 400)
            </div>
            <div class="build-btn" onclick="selectBuilding('school')">
                üéì School (Cost: 250)
            </div>
            <div class="build-btn" onclick="selectBuilding('park')">
                üå≥ Park (Cost: 75)
            </div>
            <div class="build-btn" onclick="selectBuilding('spaceport')">
                üöÄ Spaceport (Cost: 1000)
            </div>
            <div class="build-btn" onclick="selectBuilding('lab')">
                üî¨ Research Lab (Cost: 500)
            </div>
            <div class="build-btn" onclick="selectBuilding('recycler')">
                ‚ôªÔ∏è Recycler (Cost: 150)
            </div>
            <div class="build-btn" onclick="selectBuilding('solar')">
                ‚òÄÔ∏è Solar Panel (Cost: 120)
            </div>
            <div class="build-btn" onclick="selectBuilding('wind')">
                üí® Wind Turbine (Cost: 180)
            </div>
            <div class="build-btn" onclick="selectBuilding('tree')">
                üå≤ Plant Tree (Cost: 10)
            </div>
            <div class="build-btn" onclick="selectBuilding('water')">
                üíß Water Tower (Cost: 80)
            </div>
        </div>
        
        <!-- Info Panel -->
        <div id="infoPanel" class="panel">
            <div class="panel-title">üìä World Info</div>
            <div class="info-item">
                <div class="info-label">üåç Biome:</div>
                <div class="info-value" id="biomeInfo">Temperate Forest</div>
            </div>
            <div class="info-item">
                <div class="info-label">üå§Ô∏è Weather:</div>
                <div class="info-value" id="weatherInfo">Sunny</div>
            </div>
            <div class="info-item">
                <div class="info-label">üå°Ô∏è Temperature:</div>
                <div class="info-value" id="tempInfo">22¬∞C</div>
            </div>
            <div class="info-item">
                <div class="info-label">üí® Wind:</div>
                <div class="info-value" id="windInfo">Light</div>
            </div>
            <div class="info-item">
                <div class="info-label">üå± Plants:</div>
                <div class="info-value" id="plantCount">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">üêæ Animals:</div>
                <div class="info-value" id="animalCount">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">üè¢ Buildings:</div>
                <div class="info-value" id="buildingCount">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">üöÄ Space Level:</div>
                <div class="info-value" id="spaceLevel">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">üî¨ Research Points:</div>
                <div class="info-value" id="researchPoints">0</div>
            </div>
            <div class="info-item">
                <div class="info-label">üìà Growth Rate:</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="growthBar" style="width: 0%"></div>
                </div>
            </div>
        </div>
        
        <!-- Research Panel -->
        <div id="researchPanel" class="panel">
            <div class="panel-title">üî¨ Research & Technology</div>
            <div class="research-item" onclick="research('agriculture')">
                üåæ Advanced Agriculture (Cost: 50 RP)
            </div>
            <div class="research-item" onclick="research('energy')">
                ‚ö° Renewable Energy (Cost: 75 RP)
            </div>
            <div class="research-item" onclick="research('medicine')">
                üíä Modern Medicine (Cost: 100 RP)
            </div>
            <div class="research-item" onclick="research('education')">
                üìö Advanced Education (Cost: 80 RP)
            </div>
            <div class="research-item" onclick="research('space')">
                üöÄ Space Technology (Cost: 200 RP)
            </div>
            <div class="research-item" onclick="research('ai')">
                ü§ñ Artificial Intelligence (Cost: 300 RP)
            </div>
            <div class="research-item" onclick="research('environment')">
                üå± Environmental Science (Cost: 60 RP)
            </div>
            <div class="research-item" onclick="research('transport')">
                üöó Advanced Transport (Cost: 90 RP)
            </div>
            <div class="research-item" onclick="research('communication')">
                üì° Global Communication (Cost: 70 RP)
            </div>
            <div class="research-item" onclick="research('nanotech')">
                üî¨ Nanotechnology (Cost: 400 RP)
            </div>
        </div>
        
        <!-- Events Panel -->
        <div id="eventsPanel" class="panel">
            <div class="panel-title">üì∞ World Events</div>
            <div id="eventsList">
                <div class="event-item">üåç Welcome to Universal Simulation!</div>
                <div class="event-item">üéØ Click on the world to build and explore!</div>
            </div>
        </div>
    </div>
    
    <script>
        // Game state
        let gameState = {
            time: 0,
            year: 1,
            population: 0,
            resources: 1000,
            energy: 100,
            food: 100,
            techLevel: 1,
            happiness: 50,
            environment: 100,
            researchPoints: 0,
            spaceLevel: 0,
            selectedBuilding: null,
            buildings: [],
            plants: [],
            animals: [],
            weather: 'sunny',
            temperature: 22,
            wind: 'light',
            biome: 'temperate_forest',
            researched: {},
            events: [],
            growthRate: 0
        };
        
        // Canvas setup
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas size
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Building types
        const buildingTypes = {
            house: { emoji: 'üè†', name: 'House', cost: 50, produces: { population: 5, happiness: 2 }, consumes: { energy: 1, food: 1 } },
            farm: { emoji: 'üåæ', name: 'Farm', cost: 100, produces: { food: 10 }, consumes: { energy: 2 } },
            factory: { emoji: 'üè≠', name: 'Factory', cost: 200, produces: { resources: 20 }, consumes: { energy: 5, happiness: -1 } },
            powerplant: { emoji: '‚ö°', name: 'Power Plant', cost: 300, produces: { energy: 25 }, consumes: { environment: -2 } },
            hospital: { emoji: 'üè•', name: 'Hospital', cost: 400, produces: { happiness: 5, population: 2 }, consumes: { energy: 3, resources: 5 } },
            school: { emoji: 'üéì', name: 'School', cost: 250, produces: { happiness: 3, researchPoints: 1 }, consumes: { energy: 2 } },
            park: { emoji: 'üå≥', name: 'Park', cost: 75, produces: { happiness: 4, environment: 1 }, consumes: {} },
            spaceport: { emoji: 'üöÄ', name: 'Spaceport', cost: 1000, produces: { spaceLevel: 1, researchPoints: 5 }, consumes: { energy: 10, resources: 20 } },
            lab: { emoji: 'üî¨', name: 'Research Lab', cost: 500, produces: { researchPoints: 3, techLevel: 0.1 }, consumes: { energy: 4, resources: 8 } },
            recycler: { emoji: '‚ôªÔ∏è', name: 'Recycler', cost: 150, produces: { resources: 5, environment: 2 }, consumes: { energy: 2 } },
            solar: { emoji: '‚òÄÔ∏è', name: 'Solar Panel', cost: 120, produces: { energy: 8, environment: 1 }, consumes: {} },
            wind: { emoji: 'üí®', name: 'Wind Turbine', cost: 180, produces: { energy: 12, environment: 1 }, consumes: {} },
            tree: { emoji: 'üå≤', name: 'Tree', cost: 10, produces: { environment: 0.5, food: 0.1 }, consumes: {} },
            water: { emoji: 'üíß', name: 'Water Tower', cost: 80, produces: { happiness: 1, population: 1 }, consumes: { energy: 1 } }
        };
        
        // Research types
        const researchTypes = {
            agriculture: { name: 'Advanced Agriculture', cost: 50, effect: { food: 2, population: 1 } },
            energy: { name: 'Renewable Energy', cost: 75, effect: { energy: 2, environment: 1 } },
            medicine: { name: 'Modern Medicine', cost: 100, effect: { happiness: 3, population: 2 } },
            education: { name: 'Advanced Education', cost: 80, effect: { researchPoints: 2, happiness: 2 } },
            space: { name: 'Space Technology', cost: 200, effect: { spaceLevel: 1, techLevel: 1 } },
            ai: { name: 'Artificial Intelligence', cost: 300, effect: { techLevel: 2, researchPoints: 3 } },
            environment: { name: 'Environmental Science', cost: 60, effect: { environment: 2, happiness: 1 } },
            transport: { name: 'Advanced Transport', cost: 90, effect: { happiness: 2, resources: 1 } },
            communication: { name: 'Global Communication', cost: 70, effect: { happiness: 2, researchPoints: 1 } },
            nanotech: { name: 'Nanotechnology', cost: 400, effect: { techLevel: 3, resources: 2 } }
        };
        
        // Biomes
        const biomes = {
            temperate_forest: { name: 'Temperate Forest', color: '#4CAF50', plants: 10, animals: 5 },
            desert: { name: 'Desert', color: '#FF9800', plants: 2, animals: 3 },
            arctic: { name: 'Arctic', color: '#E3F2FD', plants: 1, animals: 2 },
            tropical: { name: 'Tropical Rainforest', color: '#2E7D32', plants: 20, animals: 15 },
            grassland: { name: 'Grassland', color: '#8BC34A', plants: 8, animals: 8 },
            ocean: { name: 'Ocean', color: '#2196F3', plants: 5, animals: 12 }
        };
        
        // Weather patterns
        const weatherPatterns = [
            { name: 'Sunny', temp: 25, wind: 'light', color: '#FFC107' },
            { name: 'Cloudy', temp: 20, wind: 'moderate', color: '#9E9E9E' },
            { name: 'Rainy', temp: 15, wind: 'strong', color: '#2196F3' },
            { name: 'Stormy', temp: 10, wind: 'very_strong', color: '#3F51B5' },
            { name: 'Snowy', temp: -5, wind: 'moderate', color: '#E3F2FD' }
        ];
        
        // Create starfield
        function createStarfield() {
            const starfield = document.getElementById('starfield');
            for (let i = 0; i < 300; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = Math.random() * 3 + 1 + 'px';
                star.style.height = star.style.width;
                star.style.animationDelay = Math.random() * 4 + 's';
                starfield.appendChild(star);
            }
        }
        
        // Building class
        class Building {
            constructor(x, y, type) {
                this.x = x;
                this.y = y;
                this.type = type;
                this.health = 100;
                this.efficiency = 1;
                this.age = 0;
            }
            
            draw() {
                ctx.save();
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                
                // Building shadow
                ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
                ctx.fillText(buildingTypes[this.type].emoji, this.x + 2, this.y + 2);
                
                // Building
                ctx.fillStyle = this.health > 50 ? '#fff' : '#ff6b6b';
                ctx.fillText(buildingTypes[this.type].emoji, this.x, this.y);
                
                // Health bar
                if (this.health < 100) {
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    ctx.fillRect(this.x - 15, this.y - 20, 30, 4);
                    ctx.fillStyle = this.health > 50 ? '#4ecdc4' : '#ff6b6b';
                    ctx.fillRect(this.x - 15, this.y - 20, 30 * (this.health / 100), 4);
                }
                
                ctx.restore();
            }
            
            update() {
                this.age++;
                if (this.age > 1000) {
                    this.health -= 0.1;
                }
                
                // Apply production and consumption
                const building = buildingTypes[this.type];
                Object.keys(building.produces).forEach(resource => {
                    const amount = building.produces[resource] * this.efficiency;
                    if (resource === 'population') gameState.population += amount;
                    else if (resource === 'resources') gameState.resources += amount;
                    else if (resource === 'energy') gameState.energy += amount;
                    else if (resource === 'food') gameState.food += amount;
                    else if (resource === 'happiness') gameState.happiness += amount;
                    else if (resource === 'environment') gameState.environment += amount;
                    else if (resource === 'researchPoints') gameState.researchPoints += amount;
                    else if (resource === 'spaceLevel') gameState.spaceLevel += amount;
                    else if (resource === 'techLevel') gameState.techLevel += amount;
                });
                
                Object.keys(building.consumes).forEach(resource => {
                    const amount = building.consumes[resource];
                    if (resource === 'population') gameState.population -= amount;
                    else if (resource === 'resources') gameState.resources -= amount;
                    else if (resource === 'energy') gameState.energy -= amount;
                    else if (resource === 'food') gameState.food -= amount;
                    else if (resource === 'happiness') gameState.happiness -= amount;
                    else if (resource === 'environment') gameState.environment -= amount;
                });
            }
        }
        
        // Plant class
        class Plant {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.size = Math.random() * 10 + 5;
                this.growth = 0;
                this.maxGrowth = 100;
                this.type = Math.random() > 0.5 ? 'üå≤' : 'üå≥';
            }
            
            draw() {
                ctx.save();
                ctx.font = this.size + 'px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.globalAlpha = this.growth / this.maxGrowth;
                ctx.fillText(this.type, this.x, this.y);
                ctx.restore();
            }
            
            update() {
                if (this.growth < this.maxGrowth) {
                    this.growth += 0.1;
                }
            }
        }
        
        // Animal class
        class Animal {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.vx = (Math.random() - 0.5) * 2;
                this.vy = (Math.random() - 0.5) * 2;
                this.type = ['üê¶', 'üê∞', 'ü¶ä', 'ü¶å', 'üêøÔ∏è'][Math.floor(Math.random() * 5)];
                this.energy = 100;
            }
            
            draw() {
                ctx.save();
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(this.type, this.x, this.y);
                ctx.restore();
            }
            
            update() {
                this.x += this.vx;
                this.y += this.vy;
                
                // Bounce off edges
                if (this.x < 20 || this.x > canvas.width - 20) this.vx *= -1;
                if (this.y < 20 || this.y > canvas.height - 20) this.vy *= -1;
                
                this.energy -= 0.1;
            }
        }
        
        // Game functions
        function selectBuilding(type) {
            if (gameState.resources >= buildingTypes[type].cost) {
                gameState.selectedBuilding = type;
                showMessage(`Selected ${buildingTypes[type].name}. Click to place!`);
            } else {
                showMessage('Not enough resources!');
            }
        }
        
        function placeBuilding(x, y) {
            if (gameState.selectedBuilding) {
                gameState.buildings.push(new Building(x, y, gameState.selectedBuilding));
                gameState.resources -= buildingTypes[gameState.selectedBuilding].cost;
                gameState.selectedBuilding = null;
                addEvent(`üèóÔ∏è Built ${buildingTypes[gameState.selectedBuilding].name}!`);
            }
        }
        
        function research(type) {
            const research = researchTypes[type];
            if (gameState.researchPoints >= research.cost && !gameState.researched[type]) {
                gameState.researchPoints -= research.cost;
                gameState.researched[type] = true;
                
                // Apply research effects
                Object.keys(research.effect).forEach(resource => {
                    const amount = research.effect[resource];
                    if (resource === 'population') gameState.population += amount;
                    else if (resource === 'resources') gameState.resources += amount;
                    else if (resource === 'energy') gameState.energy += amount;
                    else if (resource === 'food') gameState.food += amount;
                    else if (resource === 'happiness') gameState.happiness += amount;
                    else if (resource === 'environment') gameState.environment += amount;
                    else if (resource === 'researchPoints') gameState.researchPoints += amount;
                    else if (resource === 'spaceLevel') gameState.spaceLevel += amount;
                    else if (resource === 'techLevel') gameState.techLevel += amount;
                });
                
                addEvent(`üî¨ Researched ${research.name}!`);
                updateResearchDisplay();
            }
        }
        
        function updateResearchDisplay() {
            document.querySelectorAll('.research-item').forEach(item => {
                const researchType = item.textContent.split(' ')[1].toLowerCase();
                if (gameState.researched[researchType]) {
                    item.classList.add('researched');
                }
            });
        }
        
        function addEvent(message) {
            const eventDiv = document.createElement('div');
            eventDiv.className = 'event-item';
            eventDiv.textContent = message;
            
            const eventsList = document.getElementById('eventsList');
            eventsList.insertBefore(eventDiv, eventsList.firstChild);
            
            // Keep only last 10 events
            while (eventsList.children.length > 10) {
                eventsList.removeChild(eventsList.lastChild);
            }
        }
        
        function showMessage(message) {
            const messageDiv = document.createElement('div');
            messageDiv.style.cssText = `
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0, 0, 0, 0.9);
                border: 2px solid #4ecdc4;
                border-radius: 15px;
                padding: 20px;
                color: white;
                font-size: 1.2em;
                z-index: 1000;
                text-align: center;
            `;
            messageDiv.textContent = message;
            document.body.appendChild(messageDiv);
            
            setTimeout(() => messageDiv.remove(), 2000);
        }
        
        function updateWeather() {
            if (Math.random() < 0.01) {
                const weather = weatherPatterns[Math.floor(Math.random() * weatherPatterns.length)];
                gameState.weather = weather.name.toLowerCase();
                gameState.temperature = weather.temp;
                gameState.wind = weather.wind;
                addEvent(`üå§Ô∏è Weather changed to ${weather.name}!`);
            }
        }
        
        function spawnPlants() {
            if (Math.random() < 0.005 && gameState.environment > 50) {
                const x = Math.random() * (canvas.width - 40) + 20;
                const y = Math.random() * (canvas.height - 40) + 20;
                gameState.plants.push(new Plant(x, y));
            }
        }
        
        function spawnAnimals() {
            if (Math.random() < 0.003 && gameState.environment > 30) {
                const x = Math.random() * (canvas.width - 40) + 20;
                const y = Math.random() * (canvas.height - 40) + 20;
                gameState.animals.push(new Animal(x, y));
            }
        }
        
        function triggerRandomEvents() {
            if (Math.random() < 0.001) {
                const events = [
                    'üå™Ô∏è A storm is approaching!',
                    'üå± New plant species discovered!',
                    'üêæ Wildlife migration observed!',
                    'üåü Meteor shower tonight!',
                    'üåà Beautiful rainbow appeared!',
                    'üåä Ocean currents changing!',
                    'üåç Earth day celebration!',
                    'üöÄ Space mission successful!',
                    'üî¨ Breakthrough in research!',
                    'üéâ Population milestone reached!'
                ];
                addEvent(events[Math.floor(Math.random() * events.length)]);
            }
        }
        
        function updateDisplay() {
            document.getElementById('gameTime').textContent = `Year ${gameState.year}`;
            document.getElementById('population').textContent = Math.floor(gameState.population);
            document.getElementById('resources').textContent = Math.floor(gameState.resources);
            document.getElementById('energy').textContent = Math.floor(gameState.energy);
            document.getElementById('food').textContent = Math.floor(gameState.food);
            document.getElementById('techLevel').textContent = Math.floor(gameState.techLevel);
            document.getElementById('happiness').textContent = Math.max(0, Math.min(100, Math.floor(gameState.happiness)));
            document.getElementById('environment').textContent = Math.max(0, Math.min(100, Math.floor(gameState.environment)));
            document.getElementById('researchPoints').textContent = Math.floor(gameState.researchPoints);
            document.getElementById('spaceLevel').textContent = Math.floor(gameState.spaceLevel);
            document.getElementById('buildingCount').textContent = gameState.buildings.length;
            document.getElementById('plantCount').textContent = gameState.plants.length;
            document.getElementById('animalCount').textContent = gameState.animals.length;
            
            // Biome and weather info
            document.getElementById('biomeInfo').textContent = biomes[gameState.biome].name;
            document.getElementById('weatherInfo').textContent = gameState.weather.charAt(0).toUpperCase() + gameState.weather.slice(1);
            document.getElementById('tempInfo').textContent = `${gameState.temperature}¬∞C`;
            document.getElementById('windInfo').textContent = gameState.wind.charAt(0).toUpperCase() + gameState.wind.slice(1);
            
            // Growth rate
            gameState.growthRate = (gameState.population + gameState.buildings.length + gameState.plants.length + gameState.animals.length) / 100;
            document.getElementById('growthBar').style.width = Math.min(100, gameState.growthRate * 10) + '%';
        }
        
        function draw() {
            // Clear canvas
            ctx.fillStyle = biomes[gameState.biome].color;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw weather effects
            if (gameState.weather === 'rainy' || gameState.weather === 'stormy') {
                ctx.fillStyle = 'rgba(33, 150, 243, 0.3)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            } else if (gameState.weather === 'snowy') {
                ctx.fillStyle = 'rgba(227, 242, 253, 0.5)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }
            
            // Draw plants
            gameState.plants.forEach(plant => plant.draw());
            
            // Draw animals
            gameState.animals.forEach(animal => animal.draw());
            
            // Draw buildings
            gameState.buildings.forEach(building => building.draw());
            
            // Draw cursor building preview
            if (gameState.selectedBuilding) {
                ctx.save();
                ctx.font = '24px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.globalAlpha = 0.7;
                ctx.fillText(buildingTypes[gameState.selectedBuilding].emoji, mouseX, mouseY);
                ctx.restore();
            }
        }
        
        function update() {
            // Update time
            gameState.time++;
            if (gameState.time % 1000 === 0) {
                gameState.year++;
                addEvent(`üìÖ Year ${gameState.year} has begun!`);
            }
            
            // Update buildings
            gameState.buildings.forEach(building => building.update());
            
            // Update plants
            gameState.plants.forEach(plant => plant.update());
            
            // Update animals
            gameState.animals.forEach(animal => animal.update());
            
            // Remove dead animals
            gameState.animals = gameState.animals.filter(animal => animal.energy > 0);
            
            // Update weather
            updateWeather();
            
            // Spawn new life
            spawnPlants();
            spawnAnimals();
            
            // Random events
            triggerRandomEvents();
            
            // Ensure values stay in bounds
            gameState.happiness = Math.max(0, Math.min(100, gameState.happiness));
            gameState.environment = Math.max(0, Math.min(100, gameState.environment));
            gameState.population = Math.max(0, gameState.population);
            gameState.resources = Math.max(0, gameState.resources);
            gameState.energy = Math.max(0, gameState.energy);
            gameState.food = Math.max(0, gameState.food);
        }
        
        function gameLoop() {
            update();
            draw();
            updateDisplay();
            requestAnimationFrame(gameLoop);
        }
        
        // Mouse tracking
        let mouseX = 0, mouseY = 0;
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
        });
        
        // Click to place buildings
        canvas.addEventListener('click', (e) => {
            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            placeBuilding(x, y);
        });
        
        // Initialize game
        function init() {
            createStarfield();
            updateResearchDisplay();
            gameLoop();
            addEvent('üåç Welcome to Universal Simulation!');
            addEvent('üéØ Click to build and watch your world grow!');
        }
        
        // Start the game
        init();
        
        console.log('üåç Universal Simulation loaded! Build, research, and explore your world!');
    </script>
</body>
</html>
