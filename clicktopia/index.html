<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clickitey Clickitey</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background-color: #ffd500;
            font-family: Arial, sans-serif;
        }
        #clickArea {
            cursor: pointer;
            padding: 20px;
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            transition: transform 0.1s;
            user-select: none;
        }
        #clickArea:active {
            transform: scale(0.95);
        }
        #number {
            font-size: 72px;
            font-weight: bold;
            color: #333;
            margin: 0;
        }
        #title {
            font-size: 24px;
            color: #666;
            margin-bottom: 20px;
        }
        #stopwatch {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #fff;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
        }
        #timeWasted {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        #timer {
            font-size: 24px;
            font-weight: bold;
            color: #333;
        }
        #restartButton {
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 16px;
            color: #333;
            transition: transform 0.1s;
        }
        #restartButton:hover {
            transform: scale(1.05);
        }
        #restartButton:active {
            transform: scale(0.95);
        }
        #quitButton {
            position: fixed;
            top: 60px;
            left: 20px;
            background-color: #ff4444;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 16px;
            color: #fff;
            transition: transform 0.1s;
        }
        #quitButton:hover {
            transform: scale(1.05);
        }
        #quitButton:active {
            transform: scale(0.95);
        }
        #prButton {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #prButton:hover {
            transform: scale(1.05);
        }
        #prButton:active {
            transform: scale(0.95);
        }
        #trollModeButton {
            position: fixed;
            bottom: 60px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #trollModeButton:hover {
            transform: scale(1.05);
        }
        #trollModeButton:active {
            transform: scale(0.95);
        }
        #trollModeButton.active {
            background-color: #ff6b6b;
            color: #fff;
        }
        #clickArea.running-away {
            transition: transform 0.3s, left 0.3s, top 0.3s;
        }
        #partyModeButton {
            position: fixed;
            bottom: 100px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #partyModeButton:hover {
            transform: scale(1.05);
        }
        #partyModeButton:active {
            transform: scale(0.95);
        }
        #partyModeButton.active {
            background-color: #9b59b6;
            color: #fff;
        }
        #easyModeButton {
            position: fixed;
            bottom: 140px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #easyModeButton:hover {
            transform: scale(1.05);
        }
        #easyModeButton:active {
            transform: scale(0.95);
        }
        #easyModeButton.active {
            background-color: #2ecc71;
            color: #fff;
        }
        #speedModeButton {
            position: fixed;
            bottom: 260px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #speedModeButton:hover {
            transform: scale(1.05);
        }
        #speedModeButton:active {
            transform: scale(0.95);
        }
        #speedModeButton.active {
            background-color: #e74c3c;
            color: #fff;
        }
        #challengeModeButton {
            position: fixed;
            bottom: 220px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #challengeModeButton:hover {
            transform: scale(1.05);
        }
        #challengeModeButton:active {
            transform: scale(0.95);
        }
        #challengeModeButton.active {
            background-color: #16a085;
            color: #fff;
        }
        #multiplierModeButton {
            position: fixed;
            bottom: 180px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #multiplierModeButton:hover {
            transform: scale(1.05);
        }
        #multiplierModeButton:active {
            transform: scale(0.95);
        }
        #multiplierModeButton.active {
            background-color: #e67e22;
            color: #fff;
        }
        #challengeDisplay {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            background-color: #fff;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            z-index: 3000;
            text-align: center;
            min-width: 250px;
        }
        #challengeDisplay.active {
            display: block;
        }
        #challengeText {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        #challengeProgress {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        #challengeTimer {
            font-size: 16px;
            color: #e74c3c;
            font-weight: bold;
        }
        #colorModeButton {
            position: fixed;
            bottom: 300px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #colorModeButton:hover {
            transform: scale(1.05);
        }
        #colorModeButton:active {
            transform: scale(0.95);
        }
        #colorModeButton.active {
            background-color: #9b59b6;
            color: #fff;
        }
        #randomModeButton {
            position: fixed;
            bottom: 340px;
            right: 20px;
            background-color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-size: 12px;
            color: #333;
            transition: transform 0.1s;
        }
        #randomModeButton:hover {
            transform: scale(1.05);
        }
        #randomModeButton:active {
            transform: scale(0.95);
        }
        #randomModeButton.active {
            background-color: #e67e22;
            color: #fff;
        }
        body.shake {
            animation: shake 0.3s;
        }
        @keyframes shake {
            0%, 100% { transform: translate(0, 0); }
            10%, 30%, 50%, 70%, 90% { transform: translate(-5px, -5px); }
            20%, 40%, 60%, 80% { transform: translate(5px, 5px); }
        }
        .bubble {
            position: fixed;
            width: 80px;
            height: 80px;
            background-color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 100;
            transition: opacity 0.5s ease-out, transform 0.3s ease-out;
        }
        .bubble.popping {
            transform: scale(1.5);
            opacity: 0;
        }
        .bubble.fading {
            opacity: 0;
        }
        .party-color {
            position: fixed;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 1;
            transition: left 2s ease-in-out, top 2s ease-in-out;
        }
        body.party-mode {
            background-color: #000 !important;
        }
        #recordsOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }
        #personalRecords {
            display: none;
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 500px;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            max-height: 400px;
            overflow-y: auto;
            z-index: 1001;
        }
        #personalRecords h2 {
            margin: 0 0 10px 0;
            font-size: 18px;
            color: #333;
        }
        .record {
            padding: 8px;
            border-bottom: 1px solid #eee;
            font-size: 14px;
            color: #666;
        }
        .record:last-child {
            border-bottom: none;
        }
        .record strong {
            color: #333;
        }
        .record {
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .record:hover {
            background-color: #f0f0f0;
        }
        #deleteRecordsButton {
            margin-top: 15px;
            padding: 10px 20px;
            background-color: #ff4444;
            color: #fff;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.1s, background-color 0.2s;
        }
        #deleteRecordsButton:hover {
            background-color: #ffffff;
            transform: scale(1.05);
        }
        #deleteRecordsButton:active {
            transform: scale(0.95);
        }
        #creditsOverlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 2000;
        }
        #creditsPanel {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 600px;
            background-color: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            max-height: 80vh;
            overflow-y: auto;
            z-index: 2001;
        }
        #creditsPanel h2 {
            margin: 0 0 20px 0;
            font-size: 28px;
            color: #333;
            text-align: center;
        }
        #creditsContent {
            font-size: 16px;
            line-height: 1.6;
            color: #333;
            text-align: center;
        }
        #closeCreditsButton {
            margin-top: 20px;
            padding: 10px 30px;
            background-color: #ffd500;
            color: #333;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: transform 0.1s;
        }
        #closeCreditsButton:hover {
            transform: scale(1.05);
        }
        #closeCreditsButton:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <button id="restartButton">Restart</button>
    <button id="quitButton">Quit</button>
    <div id="stopwatch">
        <div id="timeWasted">Time Wasted</div>
        <div id="timer">00:00:00</div>
    </div>
    <h1 id="title">Clickitey Clickitey</h1>
    <div id="clickArea">
        <p id="number">0</p>
    </div>
    <button id="trollModeButton">Troll Mode</button>
    <button id="partyModeButton">Party Mode</button>
    <button id="easyModeButton">Easy Mode</button>
    <button id="multiplierModeButton">Multiplier Mode</button>
    <button id="challengeModeButton">Challenge Mode</button>
    <button id="speedModeButton">Speed Mode</button>
    <button id="colorModeButton">Color Mode</button>
    <div id="challengeDisplay">
        <div id="challengeText"></div>
        <div id="challengeProgress"></div>
        <div id="challengeTimer"></div>
    </div>
    <button id="randomModeButton">Random Mode</button>
    <button id="prButton">P.R.</button>
    <div id="recordsOverlay"></div>
    <div id="personalRecords">
        <h2>Personal Records</h2>
        <div id="recordsList"></div>
        <button id="deleteRecordsButton" style="display: none;">Delete All P.R.s</button>
    </div>
    <div id="creditsOverlay"></div>
    <div id="creditsPanel">
        <h2>ðŸŽ‰ YOU WIN! ðŸŽ‰</h2>
        <div id="creditsContent">
            <p style="font-size: 20px; font-weight: bold; margin-bottom: 30px;">APPLE BOB PRESENTS ONCE AGAIN:</p>
            <p style="font-size: 24px; font-weight: bold; margin-bottom: 30px;">CLICKTOPIA!</p>
            <p style="margin-bottom: 30px;">THIS GAME WAS HARD WORK MAKING AND WE APPRECIATE YOU PLAYING THIS BORING GAME.</p>
            <div style="margin-top: 40px; line-height: 2;">
                <p><strong>PROGRAMMER</strong> - BO BERRYMAN (ME)</p>
                <p><strong>BRAINSTORMER</strong> - ME</p>
                <p><strong>CREATOR</strong> - ME</p>
            </div>
            <p style="margin-top: 40px; font-style: italic;">THANK YOU FOR BEING AND I HOPE YOU ENJOYED CLICKTOPIA.</p>
        </div>
        <div style="text-align: center;">
            <button id="closeCreditsButton">Close</button>
        </div>
    </div>

    <script>
        let count = 0;
        const numberDisplay = document.getElementById('number');
        const clickArea = document.getElementById('clickArea');
        const timerDisplay = document.getElementById('timer');
        const restartButton = document.getElementById('restartButton');
        const quitButton = document.getElementById('quitButton');
        const recordsList = document.getElementById('recordsList');
        const prButton = document.getElementById('prButton');
        const recordsOverlay = document.getElementById('recordsOverlay');
        const personalRecords = document.getElementById('personalRecords');
        const deleteRecordsButton = document.getElementById('deleteRecordsButton');
        const creditsOverlay = document.getElementById('creditsOverlay');
        const creditsPanel = document.getElementById('creditsPanel');
        const creditsContent = document.getElementById('creditsContent');
        const closeCreditsButton = document.getElementById('closeCreditsButton');
        const trollModeButton = document.getElementById('trollModeButton');
        const partyModeButton = document.getElementById('partyModeButton');
        const easyModeButton = document.getElementById('easyModeButton');
        const multiplierModeButton = document.getElementById('multiplierModeButton');
        const challengeModeButton = document.getElementById('challengeModeButton');
        const challengeDisplay = document.getElementById('challengeDisplay');
        const challengeText = document.getElementById('challengeText');
        const challengeProgress = document.getElementById('challengeProgress');
        const challengeTimer = document.getElementById('challengeTimer');
        const speedModeButton = document.getElementById('speedModeButton');
        const colorModeButton = document.getElementById('colorModeButton');
        const randomModeButton = document.getElementById('randomModeButton');
        
        let trollMode = false;
        let partyMode = false;
        let easyMode = false;
        let multiplierMode = false;
        let challengeMode = false;
        let speedMode = false;
        let colorMode = false;
        let randomMode = false;
        
        // Multiplier Mode variables
        let multiplierClicks = 0;
        let currentMultiplier = 1;
        
        // Challenge Mode variables
        let currentChallenge = null;
        let challengeClicks = 0;
        let challengeTimeLeft = 0;
        let challengeInterval = null;
        let challengeTimeout = null;
        let speedModeStartTime = null;
        let speedModeClicks = 0;
        let speedModeInterval = null;
        let colorModeHue = 0;
        let originalBackgroundColor = '#ffd500';
        let originalClickAreaPosition = null;
        let originalQuitButtonPosition = null;
        let rainbowElements = [];
        let rainbowInterval = null;
        let bubbleInterval = null;
        let activeBubbles = [];

        // Achievement definitions (clicking milestones)
        const achievements = [];
        
        const WIN_THRESHOLD = 100000;
        let hasWon = false;
        
        // Click sound effect function
        function playClickSound() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                // Silently fail if audio context is not available
            }
        }
        
        // Calm background music using Web Audio API
        let musicAudioContext = null;
        let musicInterval = null;
        
        function startCalmMusic() {
            try {
                musicAudioContext = new (window.AudioContext || window.webkitAudioContext)();
                let currentTime = musicAudioContext.currentTime + 0.5;
                
                function playNote(frequency, duration, startTime, volume = 0.12, waveType = 'sine') {
                    const oscillator = musicAudioContext.createOscillator();
                    const gainNode = musicAudioContext.createGain();
                    
                    oscillator.connect(gainNode);
                    gainNode.connect(musicAudioContext.destination);
                    
                    oscillator.frequency.value = frequency;
                    oscillator.type = waveType;
                    
                    gainNode.gain.setValueAtTime(0, startTime);
                    gainNode.gain.linearRampToValueAtTime(volume, startTime + 0.5);
                    gainNode.gain.linearRampToValueAtTime(volume, startTime + duration - 0.5);
                    gainNode.gain.linearRampToValueAtTime(0, startTime + duration);
                    
                    oscillator.start(startTime);
                    oscillator.stop(startTime + duration);
                }
                
                // Peaceful, mature melody - ambient style
                const melody = [
                    // First section - calm and flowing
                    { freq: 220.00, dur: 2.0 }, // A (lower octave)
                    { freq: 246.94, dur: 2.0 }, // B
                    { freq: 261.63, dur: 2.5 }, // C
                    { freq: 293.66, dur: 2.0 }, // D
                    { freq: 329.63, dur: 3.0 }, // E
                    { freq: 293.66, dur: 2.0 }, // D
                    { freq: 261.63, dur: 2.5 }, // C
                    { freq: 246.94, dur: 2.0 }, // B
                    { freq: 220.00, dur: 3.5 }, // A
                    // Second section - higher, more ethereal
                    { freq: 329.63, dur: 2.0 }, // E
                    { freq: 349.23, dur: 2.0 }, // F
                    { freq: 392.00, dur: 2.5 }, // G
                    { freq: 440.00, dur: 2.0 }, // A
                    { freq: 493.88, dur: 3.0 }, // B
                    { freq: 440.00, dur: 2.0 }, // A
                    { freq: 392.00, dur: 2.5 }, // G
                    { freq: 349.23, dur: 2.0 }, // F
                    { freq: 329.63, dur: 3.5 }, // E
                    // Third section - descending resolution
                    { freq: 392.00, dur: 2.0 }, // G
                    { freq: 349.23, dur: 2.0 }, // F
                    { freq: 329.63, dur: 2.5 }, // E
                    { freq: 293.66, dur: 2.0 }, // D
                    { freq: 261.63, dur: 3.0 }, // C
                    { freq: 220.00, dur: 4.0 }, // A (long ending)
                ];
                
                function playMelody() {
                    let noteTime = currentTime;
                    melody.forEach((note, index) => {
                        // Use triangle wave for some notes to add texture
                        const waveType = (index % 3 === 0) ? 'triangle' : 'sine';
                        playNote(note.freq, note.dur, noteTime, 0.12, waveType);
                        noteTime += note.dur + 0.2; // Smooth transitions
                    });
                    currentTime = noteTime + 1.0;
                }
                
                // Play melody in a loop
                musicInterval = setInterval(() => {
                    if (musicAudioContext) {
                        playMelody();
                    }
                }, 35000);
                
                // Start with first melody
                playMelody();
            } catch (e) {
                // Silently fail if audio context is not available
            }
        }

        function getTotalClicks() {
            return parseInt(localStorage.getItem('clicktopiaTotalClicks') || '0');
        }

        function setTotalClicks(total) {
            localStorage.setItem('clicktopiaTotalClicks', total.toString());
        }

        function getUnlockedAchievements() {
            return JSON.parse(localStorage.getItem('clicktopiaAchievements') || '[]');
        }


        function checkAchievements(totalClicks) {
            // Check win condition
            if (totalClicks >= WIN_THRESHOLD && !hasWon) {
                hasWon = true;
                showCredits();
            }
        }
        
        function showCredits() {
            creditsOverlay.style.display = 'block';
            creditsPanel.style.display = 'block';
        }
        
        function hideCredits() {
            creditsOverlay.style.display = 'none';
            creditsPanel.style.display = 'none';
        }


        function makeClickAreaRunAway() {
            const maxX = window.innerWidth - clickArea.offsetWidth;
            const maxY = window.innerHeight - clickArea.offsetHeight;
            
            // Avoid the middle area - pick from edges or corners
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const avoidRadius = 200; // Avoid 200px around center
            
            let randomX, randomY;
            let attempts = 0;
            do {
                randomX = Math.random() * maxX;
                randomY = Math.random() * maxY;
                attempts++;
                // Make sure it's not too close to center
            } while (Math.abs(randomX - centerX) < avoidRadius && Math.abs(randomY - centerY) < avoidRadius && attempts < 10);
            
            clickArea.style.position = 'fixed';
            clickArea.style.left = randomX + 'px';
            clickArea.style.top = randomY + 'px';
            clickArea.classList.add('running-away');
            // Keep it there - don't reset!
        }
        
        function makeQuitButtonRunAway() {
            const maxX = window.innerWidth - quitButton.offsetWidth;
            const maxY = window.innerHeight - quitButton.offsetHeight;
            
            // Avoid the middle area - pick from edges or corners
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            const avoidRadius = 200; // Avoid 200px around center
            
            let randomX, randomY;
            let attempts = 0;
            do {
                randomX = Math.random() * maxX;
                randomY = Math.random() * maxY;
                attempts++;
                // Make sure it's not too close to center
            } while (Math.abs(randomX - centerX) < avoidRadius && Math.abs(randomY - centerY) < avoidRadius && attempts < 10);
            
            quitButton.style.position = 'fixed';
            quitButton.style.left = randomX + 'px';
            quitButton.style.top = randomY + 'px';
            quitButton.style.transition = 'left 0.3s, top 0.3s';
            // Keep it there - don't reset!
        }
        
        function makeClickAreaSmaller() {
            const currentScale = parseFloat(clickArea.style.transform?.match(/scale\(([^)]+)\)/)?.[1] || '1');
            const newScale = Math.max(0.3, currentScale - 0.1);
            clickArea.style.transform = `scale(${newScale})`;
            clickArea.style.transition = 'transform 0.2s';
        }
        
        clickArea.addEventListener('click', () => {
            if (trollMode && Math.random() < 0.5) {
                // 50% chance of troll effect
                const effect = Math.floor(Math.random() * 3);
                if (effect === 0) {
                    // Get smaller
                    makeClickAreaSmaller();
                } else if (effect === 1) {
                    // Run away
                    makeClickAreaRunAway();
                } else {
                    // Teleport somewhere else
                    makeClickAreaRunAway();
                }
                return; // Don't count the click
            }
            
            // Random Mode effects
            if (randomMode) {
                const randomEffect = Math.floor(Math.random() * 5);
                if (randomEffect === 0) {
                    // Shake
                    document.body.classList.add('shake');
                    setTimeout(() => document.body.classList.remove('shake'), 300);
                } else if (randomEffect === 1) {
                    // Change color
                    const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#6c5ce7'];
                    document.body.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                } else if (randomEffect === 2) {
                    // Scale click area
                    clickArea.style.transform = `scale(${0.8 + Math.random() * 0.4})`;
                }
            }
            
            // Color Mode
            if (colorMode) {
                colorModeHue = (colorModeHue + 10) % 360;
                document.body.style.backgroundColor = `hsl(${colorModeHue}, 70%, 85%)`;
            }
            
            // Count clicks
            let clickValue = 1;
            
            // Multiplier Mode - increase click value
            if (multiplierMode) {
                clickValue = currentMultiplier;
                multiplierClicks++;
                
                // Every 10 clicks, increase multiplier
                if (multiplierClicks % 10 === 0) {
                    currentMultiplier++;
                    multiplierModeButton.textContent = `${currentMultiplier}x Multiplier`;
                }
            }
            
            count += clickValue;
            numberDisplay.textContent = count;
            
            // Speed Mode tracking
            if (speedMode) {
                speedModeClicks += clickValue;
            }
            
            // Update total clicks and check achievements
            const totalClicks = getTotalClicks() + clickValue;
            setTotalClicks(totalClicks);
            checkAchievements(totalClicks);
            
            // Challenge Mode tracking
            if (challengeMode && currentChallenge) {
                updateChallengeProgress();
            }
        });

        // Stopwatch functionality
        let seconds = 0;
        let minutes = 0;
        let hours = 0;
        let timerInterval;

        function updateTimer() {
            seconds++;
            if (seconds === 60) {
                seconds = 0;
                minutes++;
                if (minutes === 60) {
                    minutes = 0;
                    hours++;
                }
            }

            const displayHours = hours.toString().padStart(2, '0');
            const displayMinutes = minutes.toString().padStart(2, '0');
            const displaySeconds = seconds.toString().padStart(2, '0');
            
            timerDisplay.textContent = `${displayHours}:${displayMinutes}:${displaySeconds}`;
        }

        function getCurrentTime() {
            const displayHours = hours.toString().padStart(2, '0');
            const displayMinutes = minutes.toString().padStart(2, '0');
            const displaySeconds = seconds.toString().padStart(2, '0');
            return `${displayHours}:${displayMinutes}:${displaySeconds}`;
        }

        function startTimer() {
            timerInterval = setInterval(updateTimer, 1000);
        }

        function resetGame() {
            // Reset click counter (but keep total clicks for achievements)
            count = 0;
            numberDisplay.textContent = '0';
            
            // Reset timer
            clearInterval(timerInterval);
            seconds = 0;
            minutes = 0;
            hours = 0;
            timerDisplay.textContent = '00:00:00';
            startTimer();
        }

        function saveRecord() {
            const records = JSON.parse(localStorage.getItem('clicktopiaRecords') || '[]');
            const record = {
                count: count,
                time: getCurrentTime(),
                date: new Date().toLocaleString()
            };
            records.push(record);
            localStorage.setItem('clicktopiaRecords', JSON.stringify(records));
            displayRecords();
        }

        function loadRecords() {
            displayRecords();
        }

        function displayRecords() {
            const records = JSON.parse(localStorage.getItem('clicktopiaRecords') || '[]');
            if (records.length === 0) {
                recordsList.innerHTML = '<div class="record">No records yet. Quit a game to save your first record!</div>';
                deleteRecordsButton.style.display = 'none';
                return;
            }
            deleteRecordsButton.style.display = 'block';
            recordsList.innerHTML = records.reverse().map((record, index) => 
                `<div class="record" data-count="${record.count}" data-index="${records.length - 1 - index}">
                    <strong>Number reached:</strong> ${record.count} | 
                    <strong>Time wasted:</strong> ${record.time} | 
                    ${record.date}
                </div>`
            ).join('');
            
            // Add click listeners to records
            document.querySelectorAll('.record[data-count]').forEach(recordEl => {
                recordEl.addEventListener('click', () => {
                    const recordCount = parseInt(recordEl.getAttribute('data-count'));
                    continueFromRecord(recordCount);
                });
            });
        }
        
        function deleteAllRecords() {
            if (confirm('âš ï¸ WARNING âš ï¸\n\nAre you sure you want to delete ALL your P.R.s?\n\nThey will be gone FOREVER and cannot be recovered!\n\nThis cannot be undone!')) {
                localStorage.removeItem('clicktopiaRecords');
                displayRecords();
            }
        }
        
        function continueFromRecord(recordCount) {
            count = recordCount;
            numberDisplay.textContent = count;
            hideRecords();
            // Reset timer when continuing from a record
            clearInterval(timerInterval);
            seconds = 0;
            minutes = 0;
            hours = 0;
            timerDisplay.textContent = '00:00:00';
            startTimer();
        }

        restartButton.addEventListener('click', () => {
            playClickSound();
            if (confirm('Do you really want to restart? All progress will be lost!')) {
                resetGame();
            }
        });

        quitButton.addEventListener('click', () => {
            playClickSound();
            if (trollMode) {
                // In troll mode, quit button just runs away
                makeQuitButtonRunAway();
                return;
            }
            
            if (confirm(`Quit now?\n\nNumber reached: ${count}\nTime wasted: ${getCurrentTime()}\n\nThis will save your record.`)) {
                saveRecord();
                resetGame();
            }
        });
        
        function restoreOriginalPositions() {
            // Restore click area position
            if (originalClickAreaPosition) {
                clickArea.style.position = originalClickAreaPosition.position;
                clickArea.style.left = originalClickAreaPosition.left;
                clickArea.style.top = originalClickAreaPosition.top;
                clickArea.style.transform = '';
                clickArea.style.transition = '';
                originalClickAreaPosition = null;
            }
            
            // Restore quit button position
            if (originalQuitButtonPosition) {
                quitButton.style.position = originalQuitButtonPosition.position;
                quitButton.style.left = originalQuitButtonPosition.left;
                quitButton.style.top = originalQuitButtonPosition.top;
                quitButton.style.transition = '';
                originalQuitButtonPosition = null;
            }
        }
        
        trollModeButton.addEventListener('click', () => {
            playClickSound();
            trollMode = !trollMode;
            if (trollMode) {
                trollModeButton.classList.add('active');
                trollModeButton.textContent = 'Normal Mode';
                // Store original positions
                originalClickAreaPosition = {
                    position: clickArea.style.position || '',
                    left: clickArea.style.left || '',
                    top: clickArea.style.top || ''
                };
                originalQuitButtonPosition = {
                    position: quitButton.style.position || '',
                    left: quitButton.style.left || '',
                    top: quitButton.style.top || ''
                };
            } else {
                trollModeButton.classList.remove('active');
                trollModeButton.textContent = 'Troll Mode';
                // Restore original positions
                restoreOriginalPositions();
            }
        });
        
        function createRainbowElements() {
            const colors = ['#ff0000', '#ff7f00', '#ffff00', '#00ff00', '#0000ff', '#4b0082', '#9400d3'];
            const body = document.body;
            
            // Create 7 elements, one for each color
            colors.forEach((color, index) => {
                const element = document.createElement('div');
                element.className = 'party-color';
                element.style.backgroundColor = color;
                element.style.left = Math.random() * (window.innerWidth - 30) + 'px';
                element.style.top = Math.random() * (window.innerHeight - 30) + 'px';
                body.appendChild(element);
                rainbowElements.push(element);
            });
        }
        
        function moveRainbowElements() {
            rainbowElements.forEach(element => {
                const newX = Math.random() * (window.innerWidth - 30);
                const newY = Math.random() * (window.innerHeight - 30);
                element.style.left = newX + 'px';
                element.style.top = newY + 'px';
            });
        }
        
        function startPartyMode() {
            partyMode = true;
            document.body.classList.add('party-mode');
            createRainbowElements();
            rainbowInterval = setInterval(moveRainbowElements, 2000);
        }
        
        function stopPartyMode() {
            partyMode = false;
            document.body.classList.remove('party-mode');
            rainbowElements.forEach(element => element.remove());
            rainbowElements = [];
            if (rainbowInterval) {
                clearInterval(rainbowInterval);
                rainbowInterval = null;
            }
        }
        
        partyModeButton.addEventListener('click', () => {
            playClickSound();
            if (partyMode) {
                stopPartyMode();
                partyModeButton.classList.remove('active');
                partyModeButton.textContent = 'Party Mode';
            } else {
                startPartyMode();
                partyModeButton.classList.add('active');
                partyModeButton.textContent = 'Normal Mode';
            }
        });
        
        function createBubble() {
            const bubble = document.createElement('div');
            bubble.className = 'bubble';
            const number = Math.floor(Math.random() * 9) + 2; // 2-10
            bubble.textContent = number;
            bubble.dataset.value = number;
            
            // Random position
            const maxX = window.innerWidth - 80;
            const maxY = window.innerHeight - 80;
            bubble.style.left = Math.random() * maxX + 'px';
            bubble.style.top = Math.random() * maxY + 'px';
            
            document.body.appendChild(bubble);
            activeBubbles.push(bubble);
            
            // Click handler
            bubble.addEventListener('click', () => {
                const value = parseInt(bubble.dataset.value);
                bubble.classList.add('popping');
                
                // Add to count
                const bubbleValue = value;
                count += bubbleValue;
                numberDisplay.textContent = count;
                
                // Update total clicks
                const totalClicks = getTotalClicks() + bubbleValue;
                setTotalClicks(totalClicks);
                checkAchievements(totalClicks);
                
                // Speed mode tracking
                if (speedMode) {
                    speedModeClicks += bubbleValue;
                }
                
                // Remove after animation
                setTimeout(() => {
                    bubble.remove();
                    const index = activeBubbles.indexOf(bubble);
                    if (index > -1) {
                        activeBubbles.splice(index, 1);
                    }
                }, 300);
            });
            
            // Fade away after 10 seconds if not clicked
            setTimeout(() => {
                if (bubble.parentNode) {
                    bubble.classList.add('fading');
                    setTimeout(() => {
                        bubble.remove();
                        const index = activeBubbles.indexOf(bubble);
                        if (index > -1) {
                            activeBubbles.splice(index, 1);
                        }
                    }, 500);
                }
            }, 10000);
        }
        
        function startEasyMode() {
            easyMode = true;
            // Create first bubble immediately, then every 20 seconds
            createBubble();
            bubbleInterval = setInterval(createBubble, 20000);
        }
        
        function stopEasyMode() {
            easyMode = false;
            if (bubbleInterval) {
                clearInterval(bubbleInterval);
                bubbleInterval = null;
            }
            // Remove all active bubbles
            activeBubbles.forEach(bubble => {
                bubble.remove();
            });
            activeBubbles = [];
        }
        
        easyModeButton.addEventListener('click', () => {
            playClickSound();
            if (easyMode) {
                stopEasyMode();
                easyModeButton.classList.remove('active');
                easyModeButton.textContent = 'Easy Mode';
            } else {
                startEasyMode();
                easyModeButton.classList.add('active');
                easyModeButton.textContent = 'Normal Mode';
            }
        });
        
        // Challenge Mode functions
        function createChallenge() {
            if (!challengeMode) return;
            
            const challenges = [
                { clicks: 10, time: 5, bonus: 50 },
                { clicks: 15, time: 6, bonus: 75 },
                { clicks: 20, time: 8, bonus: 100 },
                { clicks: 25, time: 10, bonus: 125 },
                { clicks: 5, time: 3, bonus: 30 },
                { clicks: 30, time: 12, bonus: 150 },
                { clicks: 12, time: 5, bonus: 60 },
                { clicks: 18, time: 7, bonus: 90 }
            ];
            
            currentChallenge = challenges[Math.floor(Math.random() * challenges.length)];
            challengeClicks = 0;
            challengeTimeLeft = currentChallenge.time;
            
            challengeText.textContent = `Challenge: Click ${currentChallenge.clicks} times in ${currentChallenge.time} seconds!`;
            challengeProgress.textContent = `Progress: ${challengeClicks}/${currentChallenge.clicks} clicks`;
            challengeTimer.textContent = `Time: ${challengeTimeLeft}s`;
            challengeDisplay.classList.add('active');
            
            // Update timer
            challengeInterval = setInterval(() => {
                challengeTimeLeft--;
                challengeTimer.textContent = `Time: ${challengeTimeLeft}s`;
                
                if (challengeTimeLeft <= 0) {
                    failChallenge();
                }
            }, 1000);
            
            // Auto-fail after time expires
            challengeTimeout = setTimeout(() => {
                if (challengeClicks < currentChallenge.clicks) {
                    failChallenge();
                }
            }, currentChallenge.time * 1000);
        }
        
        function updateChallengeProgress() {
            if (!currentChallenge) return;
            
            challengeClicks++;
            challengeProgress.textContent = `Progress: ${challengeClicks}/${currentChallenge.clicks} clicks`;
            
            if (challengeClicks >= currentChallenge.clicks) {
                completeChallenge();
            }
        }
        
        function completeChallenge() {
            if (!currentChallenge) return;
            
            clearInterval(challengeInterval);
            clearTimeout(challengeTimeout);
            
            const bonus = currentChallenge.bonus;
            count += bonus;
            numberDisplay.textContent = count;
            
            challengeText.textContent = `ðŸŽ‰ Challenge Complete! +${bonus} bonus clicks!`;
            challengeProgress.textContent = '';
            challengeTimer.textContent = '';
            
            setTimeout(() => {
                challengeDisplay.classList.remove('active');
                currentChallenge = null;
                challengeClicks = 0;
                
                // Create new challenge after 2 seconds
                if (challengeMode) {
                    setTimeout(createChallenge, 2000);
                }
            }, 2000);
        }
        
        function failChallenge() {
            if (!currentChallenge) return;
            
            clearInterval(challengeInterval);
            clearTimeout(challengeTimeout);
            
            challengeText.textContent = 'âŒ Challenge Failed!';
            challengeProgress.textContent = '';
            challengeTimer.textContent = '';
            
            setTimeout(() => {
                challengeDisplay.classList.remove('active');
                currentChallenge = null;
                challengeClicks = 0;
                
                // Create new challenge after 2 seconds
                if (challengeMode) {
                    setTimeout(createChallenge, 2000);
                }
            }, 2000);
        }
        
        function startChallengeMode() {
            challengeMode = true;
            challengeModeButton.classList.add('active');
            challengeModeButton.textContent = 'Normal Mode';
            createChallenge();
        }
        
        function stopChallengeMode() {
            challengeMode = false;
            challengeModeButton.classList.remove('active');
            challengeModeButton.textContent = 'Challenge Mode';
            
            if (challengeInterval) {
                clearInterval(challengeInterval);
            }
            if (challengeTimeout) {
                clearTimeout(challengeTimeout);
            }
            
            challengeDisplay.classList.remove('active');
            currentChallenge = null;
            challengeClicks = 0;
        }
        
        challengeModeButton.addEventListener('click', () => {
            playClickSound();
            if (challengeMode) {
                stopChallengeMode();
            } else {
                startChallengeMode();
            }
        });
        
        // Multiplier Mode - increases click value every 10 clicks
        multiplierModeButton.addEventListener('click', () => {
            playClickSound();
            multiplierMode = !multiplierMode;
            if (multiplierMode) {
                multiplierModeButton.classList.add('active');
                multiplierModeButton.textContent = '1x Multiplier';
                multiplierClicks = 0;
                currentMultiplier = 1;
            } else {
                multiplierModeButton.classList.remove('active');
                multiplierModeButton.textContent = 'Multiplier Mode';
                multiplierClicks = 0;
                currentMultiplier = 1;
            }
        });
        
        // Speed Mode - shows clicks per second
        speedModeButton.addEventListener('click', () => {
            playClickSound();
            speedMode = !speedMode;
            if (speedMode) {
                speedModeButton.classList.add('active');
                speedModeStartTime = Date.now();
                speedModeClicks = 0;
                // Update speed display every second
                speedModeInterval = setInterval(() => {
                    if (!speedMode) {
                        clearInterval(speedModeInterval);
                        return;
                    }
                    const elapsed = (Date.now() - speedModeStartTime) / 1000;
                    if (elapsed > 0) {
                        const cps = (speedModeClicks / elapsed).toFixed(1);
                        speedModeButton.textContent = `${cps} cps`;
                    }
                }, 1000);
            } else {
                speedModeButton.classList.remove('active');
                speedModeButton.textContent = 'Speed Mode';
                if (speedModeInterval) {
                    clearInterval(speedModeInterval);
                    speedModeInterval = null;
                }
                speedModeStartTime = null;
                speedModeClicks = 0;
            }
        });
        
        // Color Mode - background changes color on each click
        colorModeButton.addEventListener('click', () => {
            playClickSound();
            colorMode = !colorMode;
            if (colorMode) {
                colorModeButton.classList.add('active');
                colorModeButton.textContent = 'Normal Mode';
                colorModeHue = 0;
            } else {
                colorModeButton.classList.remove('active');
                colorModeButton.textContent = 'Color Mode';
                document.body.style.backgroundColor = originalBackgroundColor;
            }
        });
        
        // Random Mode - random effects happen when clicking
        randomModeButton.addEventListener('click', () => {
            playClickSound();
            randomMode = !randomMode;
            if (randomMode) {
                randomModeButton.classList.add('active');
                randomModeButton.textContent = 'Normal Mode';
            } else {
                randomModeButton.classList.remove('active');
                randomModeButton.textContent = 'Random Mode';
                document.body.style.backgroundColor = originalBackgroundColor;
                clickArea.style.transform = '';
            }
        });

        function showRecords() {
            recordsOverlay.style.display = 'block';
            personalRecords.style.display = 'block';
        }

        function hideRecords() {
            recordsOverlay.style.display = 'none';
            personalRecords.style.display = 'none';
        }

        prButton.addEventListener('click', (e) => {
            e.stopPropagation();
            playClickSound();
            showRecords();
        });

        recordsOverlay.addEventListener('click', () => {
            hideRecords();
        });

        personalRecords.addEventListener('click', (e) => {
            e.stopPropagation();
        });

        deleteRecordsButton.addEventListener('click', (e) => {
            e.stopPropagation();
            playClickSound();
            deleteAllRecords();
        });

        closeCreditsButton.addEventListener('click', (e) => {
            e.stopPropagation();
            playClickSound();
            hideCredits();
        });

        creditsOverlay.addEventListener('click', () => {
            hideCredits();
        });

        creditsPanel.addEventListener('click', (e) => {
            e.stopPropagation();
        });

        // Load records when page loads
        loadRecords();
        
        // Start calm background music
        startCalmMusic();

        // Check win condition on page load
        const currentTotalClicks = getTotalClicks();
        if (currentTotalClicks >= WIN_THRESHOLD) {
            hasWon = true;
        }
        checkAchievements(currentTotalClicks);

        // Start the timer immediately when the page loads
        startTimer();
    </script>
</body>
</html>
